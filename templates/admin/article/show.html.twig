{% extends 'admin/layout.html.twig' %}

{% block body_id 'admin_article_show' %}

{% block main %}
    <h1>{{ article.title }}</h1>

    <p class="post-metadata">
        <span class="metadata"><twig:ux:icon name="tabler:calendar-month"/> {{ article.publishedAt|format_datetime('long', 'medium', '', 'UTC') }}</span>
        <span class="metadata"><twig:ux:icon name="tabler:user"/> {{ article.author.fullName }}</span>
    </p>

    <div class="bg-body-tertiary mb-3 p-3 rounded">
        <p class="mb-0"><strong>{{ 'label.summary'|trans }}</strong>: {{ article.summary }}</p>
    </div>

    {{ article.content|markdown_to_html|sanitize_html }}

    {% if article.images is not empty %}
        <h3>Images</h3>
        <div class="row mb-3">
            {% for image in article.images %}
                <div class="col-md-3 mb-3">
                     <div class="card h-100">
                        <img src="{{ vich_uploader_asset(image, 'file') }}" class="card-img-top object-fit-cover" style="height: 150px;" alt="{{ image.caption }}">
                        <div class="card-body">
                            <p class="card-text small text-muted">{{ image.caption|default('No caption') }}</p>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% endif %}

    {% if article.videos is not empty %}
        <h3>Videos</h3>
        <div class="row mb-3">
            {% for video in article.videos %}
                <div class="col-md-4 mb-3">
                     <div class="ratio ratio-16x9 mb-2">
                        <iframe src="{{ video.url|replace({'watch?v=': 'embed/'}) }}" title="{{ video.caption }}" allowfullscreen></iframe>
                    </div>
                    <p class="small text-muted">{{ video.caption|default('No caption') }}</p>
                </div>
            {% endfor %}
        </div>
    {% endif %}

    {{ include('article/_article_tags.html.twig') }}
{% endblock %}

{% block sidebar %}
    <div class="section">
        <a href="{{ path('admin_article_edit', {id: article.id}) }}" class="btn btn-lg btn-block btn-success">
            <twig:ux:icon name="tabler:pencil"/> {{ 'action.edit_contents'|trans }}
        </a>
    </div>

    <div class="section">
        {{ include('admin/article/_delete_form.html.twig', {article: article}, with_context: false) }}
    </div>

    {{ parent() }}

    {{ show_source_code(_self) }}
{% endblock %}
